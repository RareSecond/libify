{
  "openapi": "3.0.0",
  "paths": {
    "/": {
      "get": {
        "operationId": "AppController_getHello",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        },
        "tags": [
          "App"
        ]
      }
    },
    "/auth/profile": {
      "get": {
        "operationId": "AuthController_getProfile",
        "parameters": [],
        "responses": {
          "200": {
            "description": "User profile",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserDto"
                }
              }
            }
          }
        },
        "tags": [
          "Auth"
        ]
      }
    },
    "/auth/logout": {
      "post": {
        "operationId": "AuthController_logout",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "Auth"
        ]
      }
    },
    "/auth/spotify": {
      "get": {
        "operationId": "AuthController_spotifyAuth",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Auth"
        ]
      }
    },
    "/auth/spotify/callback": {
      "get": {
        "operationId": "AuthController_spotifyCallback",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Auth"
        ]
      }
    },
    "/library/tracks/{trackId}/tags": {
      "post": {
        "operationId": "LibraryController_addTagToTrack",
        "parameters": [
          {
            "name": "trackId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AddTagToTrackDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Tag added to track"
          },
          "201": {
            "description": ""
          },
          "404": {
            "description": "Track or tag not found"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Add a tag to a track",
        "tags": [
          "library"
        ]
      }
    },
    "/library/tags": {
      "post": {
        "operationId": "LibraryController_createTag",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateTagDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Tag created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TagResponseDto"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Create a new tag",
        "tags": [
          "library"
        ]
      },
      "get": {
        "operationId": "LibraryController_getTags",
        "parameters": [],
        "responses": {
          "200": {
            "description": "List of tags",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/TagResponseDto"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Get all user tags",
        "tags": [
          "library"
        ]
      }
    },
    "/library/tags/{tagId}": {
      "delete": {
        "operationId": "LibraryController_deleteTag",
        "parameters": [
          {
            "name": "tagId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          },
          "204": {
            "description": "Tag deleted"
          },
          "404": {
            "description": "Tag not found"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Delete a tag",
        "tags": [
          "library"
        ]
      },
      "put": {
        "operationId": "LibraryController_updateTag",
        "parameters": [
          {
            "name": "tagId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateTagDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Tag updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TagResponseDto"
                }
              }
            }
          },
          "404": {
            "description": "Tag not found"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Update a tag",
        "tags": [
          "library"
        ]
      }
    },
    "/library/sync/status": {
      "get": {
        "operationId": "LibraryController_getSyncStatus",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Sync status retrieved"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Get library sync status",
        "tags": [
          "library"
        ]
      }
    },
    "/library/tracks": {
      "get": {
        "operationId": "LibraryController_getTracks",
        "parameters": [
          {
            "name": "minRating",
            "required": false,
            "in": "query",
            "description": "Filter by minimum rating",
            "schema": {
              "minimum": 1,
              "maximum": 5,
              "type": "number"
            }
          },
          {
            "name": "page",
            "required": false,
            "in": "query",
            "description": "Page number",
            "schema": {
              "minimum": 1,
              "default": 1,
              "type": "number"
            }
          },
          {
            "name": "pageSize",
            "required": false,
            "in": "query",
            "description": "Page size",
            "schema": {
              "minimum": 1,
              "maximum": 100,
              "default": 20,
              "type": "number"
            }
          },
          {
            "name": "search",
            "required": false,
            "in": "query",
            "description": "Search query for title, artist or album",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "sortBy",
            "required": false,
            "in": "query",
            "description": "Sort field",
            "schema": {
              "type": "string",
              "enum": [
                "title",
                "artist",
                "album",
                "addedAt",
                "lastPlayedAt",
                "totalPlayCount",
                "rating"
              ]
            }
          },
          {
            "name": "sortOrder",
            "required": false,
            "in": "query",
            "description": "Sort order",
            "schema": {
              "default": "desc",
              "type": "string",
              "enum": [
                "asc",
                "desc"
              ]
            }
          },
          {
            "name": "tagIds",
            "required": false,
            "in": "query",
            "description": "Filter by tag IDs",
            "schema": {
              "type": "array",
              "items": {
                "type": "string",
                "format": "uuid"
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Paginated list of user tracks",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedTracksDto"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Get user tracks",
        "tags": [
          "library"
        ]
      }
    },
    "/library/tracks/{trackId}/play": {
      "post": {
        "operationId": "LibraryController_playTrack",
        "parameters": [
          {
            "name": "trackId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Track started playing"
          },
          "201": {
            "description": ""
          },
          "400": {
            "description": "Bad request"
          },
          "401": {
            "description": "Unauthorized"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Play a track on Spotify",
        "tags": [
          "library"
        ]
      }
    },
    "/library/tracks/{trackId}/tags/{tagId}": {
      "delete": {
        "operationId": "LibraryController_removeTagFromTrack",
        "parameters": [
          {
            "name": "trackId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "tagId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Tag removed from track"
          },
          "404": {
            "description": "Track not found"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Remove a tag from a track",
        "tags": [
          "library"
        ]
      }
    },
    "/library/sync": {
      "post": {
        "operationId": "LibraryController_syncLibrary",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Library sync completed"
          },
          "201": {
            "description": ""
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Sync user library from Spotify",
        "tags": [
          "library"
        ]
      }
    },
    "/library/sync/recent": {
      "post": {
        "operationId": "LibraryController_syncRecentlyPlayed",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Recently played tracks synced"
          },
          "201": {
            "description": ""
          },
          "401": {
            "description": "Unauthorized"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Sync recently played tracks from Spotify",
        "tags": [
          "library"
        ]
      }
    },
    "/library/tracks/{trackId}/rating": {
      "put": {
        "operationId": "LibraryController_updateTrackRating",
        "parameters": [
          {
            "name": "trackId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateRatingDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Rating updated"
          },
          "404": {
            "description": "Track not found"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Update track rating",
        "tags": [
          "library"
        ]
      }
    },
    "/library/albums": {
      "get": {
        "operationId": "LibraryController_getAlbums",
        "parameters": [
          {
            "name": "page",
            "required": true,
            "in": "query",
            "schema": {
              "type": "number"
            }
          },
          {
            "name": "pageSize",
            "required": true,
            "in": "query",
            "schema": {
              "type": "number"
            }
          },
          {
            "name": "search",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "sortBy",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "sortOrder",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Paginated list of albums",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedAlbumsDto"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Get all albums in user library",
        "tags": [
          "library"
        ]
      }
    },
    "/playlists": {
      "post": {
        "operationId": "PlaylistsController_create",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateSmartPlaylistDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SmartPlaylistDto"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Create a new smart playlist",
        "tags": [
          "playlists"
        ]
      },
      "get": {
        "operationId": "PlaylistsController_findAll",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/SmartPlaylistWithTracksDto"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Get all smart playlists",
        "tags": [
          "playlists"
        ]
      }
    },
    "/playlists/{id}": {
      "get": {
        "operationId": "PlaylistsController_findOne",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SmartPlaylistWithTracksDto"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Get a smart playlist by ID",
        "tags": [
          "playlists"
        ]
      },
      "put": {
        "operationId": "PlaylistsController_update",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateSmartPlaylistDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SmartPlaylistDto"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Update a smart playlist",
        "tags": [
          "playlists"
        ]
      },
      "delete": {
        "operationId": "PlaylistsController_remove",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          },
          "204": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Delete a smart playlist",
        "tags": [
          "playlists"
        ]
      }
    },
    "/playlists/{id}/tracks": {
      "get": {
        "operationId": "PlaylistsController_getTracks",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "page",
            "required": false,
            "in": "query",
            "schema": {
              "type": "number"
            }
          },
          {
            "name": "pageSize",
            "required": false,
            "in": "query",
            "schema": {
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Get tracks for a smart playlist",
        "tags": [
          "playlists"
        ]
      }
    }
  },
  "info": {
    "title": "Mynance API",
    "description": "The Mynance API description",
    "version": "0.0.1",
    "contact": {}
  },
  "tags": [
    {
      "name": "mynance",
      "description": ""
    }
  ],
  "servers": [],
  "components": {
    "schemas": {
      "UserDto": {
        "type": "object",
        "properties": {
          "createdAt": {
            "format": "date-time",
            "type": "string"
          },
          "email": {
            "type": "string",
            "format": "email"
          },
          "id": {
            "type": "number"
          },
          "name": {
            "type": "string"
          },
          "provider": {
            "type": "string"
          },
          "updatedAt": {
            "format": "date-time",
            "type": "string"
          }
        },
        "required": [
          "createdAt",
          "email",
          "id",
          "provider",
          "updatedAt"
        ]
      },
      "AddTagToTrackDto": {
        "type": "object",
        "properties": {
          "tagId": {
            "type": "string",
            "format": "uuid",
            "description": "Tag ID to add to the track"
          }
        },
        "required": [
          "tagId"
        ]
      },
      "CreateTagDto": {
        "type": "object",
        "properties": {
          "color": {
            "type": "string",
            "pattern": "^#?([0-9A-F]{3}|[0-9A-F]{4}|[0-9A-F]{6}|[0-9A-F]{8})$",
            "description": "Tag color in hex format"
          },
          "name": {
            "type": "string",
            "description": "Tag name"
          }
        },
        "required": [
          "name"
        ]
      },
      "TagResponseDto": {
        "type": "object",
        "properties": {
          "color": {
            "type": "string"
          },
          "createdAt": {
            "format": "date-time",
            "type": "string"
          },
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          }
        },
        "required": [
          "createdAt",
          "id",
          "name"
        ]
      },
      "TagDto": {
        "type": "object",
        "properties": {
          "color": {
            "type": "string"
          },
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          }
        },
        "required": [
          "id",
          "name"
        ]
      },
      "TrackDto": {
        "type": "object",
        "properties": {
          "addedAt": {
            "format": "date-time",
            "type": "string"
          },
          "album": {
            "type": "string"
          },
          "albumArt": {
            "type": "string"
          },
          "artist": {
            "type": "string"
          },
          "duration": {
            "type": "number",
            "description": "Duration in milliseconds"
          },
          "id": {
            "type": "string"
          },
          "lastPlayedAt": {
            "format": "date-time",
            "type": "string"
          },
          "ratedAt": {
            "format": "date-time",
            "type": "string"
          },
          "rating": {
            "type": "number",
            "maximum": 5,
            "minimum": 1
          },
          "spotifyId": {
            "type": "string"
          },
          "tags": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TagDto"
            }
          },
          "title": {
            "type": "string"
          },
          "totalPlayCount": {
            "type": "number"
          }
        },
        "required": [
          "addedAt",
          "artist",
          "duration",
          "id",
          "spotifyId",
          "tags",
          "title",
          "totalPlayCount"
        ]
      },
      "PaginatedTracksDto": {
        "type": "object",
        "properties": {
          "page": {
            "type": "number"
          },
          "pageSize": {
            "type": "number"
          },
          "total": {
            "type": "number"
          },
          "totalPages": {
            "type": "number"
          },
          "tracks": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TrackDto"
            }
          }
        },
        "required": [
          "page",
          "pageSize",
          "total",
          "totalPages",
          "tracks"
        ]
      },
      "UpdateTagDto": {
        "type": "object",
        "properties": {
          "color": {
            "type": "string",
            "pattern": "^#?([0-9A-F]{3}|[0-9A-F]{4}|[0-9A-F]{6}|[0-9A-F]{8})$",
            "description": "Tag color in hex format"
          },
          "name": {
            "type": "string",
            "description": "Tag name"
          }
        }
      },
      "UpdateRatingDto": {
        "type": "object",
        "properties": {
          "rating": {
            "type": "number",
            "minimum": 1,
            "maximum": 5,
            "description": "Rating value (1-5)",
            "example": 5
          }
        },
        "required": [
          "rating"
        ]
      },
      "AlbumDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Album name"
          },
          "artist": {
            "type": "string",
            "description": "Album artist"
          },
          "albumArt": {
            "type": "string",
            "nullable": true,
            "description": "Album artwork URL"
          },
          "trackCount": {
            "type": "number",
            "description": "Number of tracks from this album in library"
          },
          "totalDuration": {
            "type": "number",
            "description": "Total duration of all tracks in milliseconds"
          },
          "totalPlayCount": {
            "type": "number",
            "description": "Total play count across all tracks"
          },
          "avgRating": {
            "type": "number",
            "nullable": true,
            "description": "Average rating of rated tracks"
          },
          "firstAdded": {
            "format": "date-time",
            "type": "string",
            "description": "Date when first track from album was added"
          },
          "lastPlayed": {
            "format": "date-time",
            "type": "string",
            "nullable": true,
            "description": "Date when any track from album was last played"
          }
        },
        "required": [
          "name",
          "artist",
          "albumArt",
          "trackCount",
          "totalDuration",
          "totalPlayCount",
          "avgRating",
          "firstAdded",
          "lastPlayed"
        ]
      },
      "PaginatedAlbumsDto": {
        "type": "object",
        "properties": {
          "albums": {
            "description": "List of albums",
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AlbumDto"
            }
          },
          "total": {
            "type": "number",
            "description": "Total number of albums"
          },
          "page": {
            "type": "number",
            "description": "Current page number"
          },
          "pageSize": {
            "type": "number",
            "description": "Number of items per page"
          },
          "totalPages": {
            "type": "number",
            "description": "Total number of pages"
          }
        },
        "required": [
          "albums",
          "total",
          "page",
          "pageSize",
          "totalPages"
        ]
      },
      "PlaylistRuleDto": {
        "type": "object",
        "properties": {
          "field": {
            "enum": [
              "title",
              "artist",
              "album",
              "rating",
              "playCount",
              "lastPlayed",
              "dateAdded",
              "tag",
              "duration"
            ],
            "type": "string"
          },
          "operator": {
            "enum": [
              "contains",
              "notContains",
              "equals",
              "notEquals",
              "greaterThan",
              "lessThan",
              "startsWith",
              "endsWith",
              "inLast",
              "notInLast",
              "hasTag",
              "notHasTag"
            ],
            "type": "string"
          },
          "value": {
            "type": "string"
          },
          "numberValue": {
            "type": "number"
          },
          "daysValue": {
            "type": "number",
            "description": "For date rules - number of days"
          }
        },
        "required": [
          "field",
          "operator"
        ]
      },
      "PlaylistCriteriaDto": {
        "type": "object",
        "properties": {
          "rules": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PlaylistRuleDto"
            }
          },
          "logic": {
            "default": "and",
            "enum": [
              "and",
              "or"
            ],
            "type": "string"
          },
          "limit": {
            "type": "number",
            "description": "Maximum number of tracks"
          },
          "orderBy": {
            "type": "string",
            "description": "Order by field"
          },
          "orderDirection": {
            "type": "object",
            "description": "Order direction"
          }
        },
        "required": [
          "rules"
        ]
      },
      "CreateSmartPlaylistDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "criteria": {
            "$ref": "#/components/schemas/PlaylistCriteriaDto"
          },
          "isActive": {
            "type": "boolean",
            "default": true
          }
        },
        "required": [
          "name",
          "criteria"
        ]
      },
      "SmartPlaylistDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "criteria": {
            "$ref": "#/components/schemas/PlaylistCriteriaDto"
          },
          "isActive": {
            "type": "boolean"
          },
          "lastUpdated": {
            "format": "date-time",
            "type": "string"
          },
          "createdAt": {
            "format": "date-time",
            "type": "string"
          }
        },
        "required": [
          "id",
          "name",
          "criteria",
          "isActive",
          "lastUpdated",
          "createdAt"
        ]
      },
      "SmartPlaylistWithTracksDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "criteria": {
            "$ref": "#/components/schemas/PlaylistCriteriaDto"
          },
          "isActive": {
            "type": "boolean"
          },
          "lastUpdated": {
            "format": "date-time",
            "type": "string"
          },
          "createdAt": {
            "format": "date-time",
            "type": "string"
          },
          "trackCount": {
            "type": "number"
          }
        },
        "required": [
          "id",
          "name",
          "criteria",
          "isActive",
          "lastUpdated",
          "createdAt",
          "trackCount"
        ]
      },
      "UpdateSmartPlaylistDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "criteria": {
            "$ref": "#/components/schemas/PlaylistCriteriaDto"
          },
          "isActive": {
            "type": "boolean"
          }
        }
      }
    }
  }
}